# Persona Data Model — Reference

## Core Entities

### 1. Inquiry (inq_...)
Central entity representing one verification session.

**Key fields:**
- Inquiry ID: `inq_Wt77vKHwYVYFciFNNDQpvggYy6jD`
- Status: `created` → `pending` → `completed` → `approved` / `declined` / `needs_review`
- Template: reference to Inquiry Template
- Account ID: link to Account
- Reference ID: optional external ID
- Time to Finish: duration
- List Matches: count of AML/sanction matches

**Tabs/sections in detail view:**
- Overview — summary, collected photos, attributes, location, signals, behavioral risk
- Verifications (N) — linked verification results
- Sessions (N) — browser/device sessions
- Signals — risk signals
- Reports (N) — AML/watchlist reports
- List matches (N) — sanction list matches

### 2. Verification (ver_...)
Individual verification check (document or selfie).

**Types:**
- Government ID — document scan + OCR + fraud checks
- Selfie — liveness detection + face matching

**Key fields:**
- Verification ID
- Type: `government_id` | `selfie`
- Status: `passed` | `failed` | `requires_retry`
- Created at
- Checks: array of individual check results

**Government ID Checks (35+):**

*Required:*
- Age comparison, Color, Compromised submission, Allowed country, Allowed ID type
- Double side, Government ID, Expiration, Fabrication, MRZ Detected
- Portrait clarity, Portrait, ID-to-Selfie comparison, ID image tampering
- Processable submission

*Optional:*
- Account comparison, Barcode, Barcode inconsistency, Blur, Damaged detection
- Electronic replica, Experimental, Extracted properties, Extraction inconsistency
- Glare, Handwriting, Inconsistent repeat, Inquiry comparison, MRZ Inconsistency
- ID number format inconsistency, Paper detection, ID physical tampering
- PO box, Public figure, Repeat, Valid dates, Video quality

**Selfie Checks (12+):**

*Required:*
- Selfie-to-ID comparison, Pose position, Multiple faces, Pose repeat
- Suspicious entity, Selfie liveness, Face covering

*Optional:*
- Account comparison, Glasses, Glare, Experimental, Portrait quality

### 3. Report (rep_...)
AML/compliance report, auto-generated by Workflow.

**Types:**
- Watchlist Report — sanction list screening
- Politically Exposed Person (PEP) Report

**Key fields:**
- Report ID
- Primary Input: name + birthdate
- Status: `no_matches` | `match` | `pending`
- Template: report template reference
- Continuous Monitoring: on/off
- Created by: Workflow Run / Manual

### 4. Account (act_...)
User profile aggregating all verification data.

**Key fields:**
- Account ID
- Name, Birthdate, Address, Age
- Status: `default` | custom statuses
- Type: `User`
- Reference ID: external ID
- Profile photo (from selfie)

**Related entities:**
- Inquiries (1:many)
- Verifications (1:many)
- Reports (1:many)
- Documents (1:many)
- List matches

### 5. Transaction (txn_...)
Financial transaction monitoring (created via API).

**Key fields:**
- Transaction ID, Reference ID, Type
- Status, Created at, Updated at

---

## Relationships

```
Account (act_...)
├── Inquiry (inq_...) [1:many]
│   ├── Verification (ver_...) [1:many]
│   │   └── Checks [1:many]
│   ├── Report (rep_...) [1:many]
│   ├── Session [1:many]
│   ├── Signals [1:many]
│   └── List matches [1:many]
└── Transaction (txn_...) [1:many]
```

---

## Signals (Risk Indicators)

| Signal | Value Type | Description |
|--------|-----------|-------------|
| Behavior Threat Level | Low/Medium/High | Overall behavioral risk |
| Geolocation To Residency Delta | km | Distance between IP and declared address |
| Proxy Detected | boolean | VPN/proxy usage |
| Rooted Device Detected | boolean | Jailbroken device |
| Sessions Geolocation Delta | m | Location change between sessions |
| Network Threat Level | Low/Medium/High | Network risk assessment |
| User Agent Spoof Attempts | count | Browser fingerprint tampering |

## Behavioral Risk Signals

| Category | Metrics |
|----------|---------|
| Overall risk scores | Behavior threat level, Bot score |
| Spoof attempts | Request spoof, User agent spoof, Restricted SDK/API |
| User behavior | Completion time, Distraction events, Hesitation % |
| Form filling | Shortcut copies, Pastes, Autofill starts |

---

## Verification Flow Steps

Standard KYC + AML flow:
1. Getting started (consent)
2. Country selection
3. Document type selection
4. Document photo (front, optionally back)
5. Photo confirmation
6. Selfie capture (center, left, right)
7. Processing
8. Success / Fail / Retry

## Statuses Lifecycle

```
Inquiry: created → pending → completed → [approved | declined | needs_review]
Verification: initiated → submitted → passed | failed | requires_retry
Report: pending → ready (no_matches | match)
Account: default → custom statuses via workflow
```
